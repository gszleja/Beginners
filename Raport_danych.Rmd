---
title: "Analiza danych - Kredyt Hipoteczny"
author: "Gracjan, Mateusz"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  markdown: 
    wrap: 72
---

#Instalacja Pakietów

if (! require("tidyverse")) install.packages("tidyverse", dependencies =TRUE)
if (! require("dlookr")) install.packages("dlookr", dependencies =TRUE)
if (! require("VIM")) install.packages("VIM", dependencies = TRUE)
if (! require("validate")) install.packages("validate", dependencies =TRUE)
if (! require("dplyr")) install.packages("dplyr", dependencies =TRUE)
if (! require("readr")) install.packages("readr", dependencies =TRUE)
if (! require("gtsummary")) install.packages("gtsummary",dependencies = TRUE)
if (! require("summarytools")) install.packages("summarytools",dependencies = TRUE)
if (! require("validate")) install.packages("validate", dependencies = TRUE)
if (! require("dplyr")) install.packages("dplyr", dependencies = TRUE)
if (! require("readr")) install.packages("readr", dependencies = TRUE)
if (! require("gtsummary")) install.packages("gtsummary", dependencies = TRUE)
if (! require("summarytools")) install.packages
if (! require("ggstatsplot")) install.packages("ggstatsplot", dependencies = TRUE)
if (! require("knitr")) install.packages("knitr", dependencies = TRUE)
if (! require("kableExtra")) install.packages("kableExtra", dependencies = TRUE)
  

#Wczytywanie bibliotek

library(tidyverse)
library(dlookr)
library(VIM)
library(validate)
library(readr)
library(dplyr)
library(gtsummary)
library(summarytools)
library(ggstatsplot)
library(knitr)
library(kableExtra)


#Wproadzenie danych

```{r}
Hipoteczny <- read_delim("Hipoteczny.csv", 
    delim = ";", escape_double = FALSE, trim_ws = TRUE)
hipo_baza <- Hipoteczny
```
##Czyszczenie danych
#Zamiana pustych wartości na unikalne

```{r}
sum(is.na(hipo_baza))

getmode <- function(v) {
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}
hipo_baza$Gender[is.na(hipo_baza$Gender)] <- getmode(hipo_baza$Gender)
hipo_baza$Married[is.na(hipo_baza$Married)] <- getmode(hipo_baza$Married)
hipo_baza$Dependents[is.na(hipo_baza$Dependents)] <- getmode(hipo_baza$Dependents)
hipo_baza$Education[is.na(hipo_baza$Education)] <- getmode(hipo_baza$Education)
hipo_baza$Self_Employed[is.na(hipo_baza$Self_Employed)] <- getmode(hipo_baza$Self_Employed)
hipo_baza$ApplicantIncome[is.na(hipo_baza$ApplicantIncome)] <- getmode(hipo_baza$ApplicantIncome)
hipo_baza$CoapplicantIncome[is.na(hipo_baza$CoapplicantIncome)] <- getmode(hipo_baza$CoapplicantIncome)
hipo_baza$LoanAmount[is.na(hipo_baza$LoanAmount)] <- getmode(hipo_baza$LoanAmount)
hipo_baza$Loan_Amount_Term[is.na(hipo_baza$Loan_Amount_Term)] <- getmode(hipo_baza$Loan_Amount_Term)
hipo_baza$Credit_History[is.na(hipo_baza$Credit_History)] <- getmode(hipo_baza$Credit_History)
hipo_baza$Property_Area[is.na(hipo_baza$Property_Area)] <- getmode(hipo_baza$Property_Area)
sum(is.na(hipo_baza))

```

#Sprwadzanie i usuwanie dupliatów

```{r}
sum(duplicated(hipo_baza$Loan_ID))
hipo_baza <- hipo_baza[!duplicated(hipo_baza$Loan_ID), ]
sum(duplicated(hipo_baza$Loan_ID))
```

#Zmiana danych, aby były zapisane małymi literami

```{r}
hipo_baza$Gender <- tolower(hipo_baza$Gender)
hipo_baza$Married <- tolower(hipo_baza$Married)
hipo_baza$Education <- tolower(hipo_baza$Education)
hipo_baza$Self_Employed <- tolower(hipo_baza$Self_Employed)
hipo_baza$Property_Area <- tolower(hipo_baza$Property_Area)
```

#Usuwanie błednych wartości

```{r}
sum(!grepl("LP", hipo_baza$Loan_ID))
hipo_baza <- hipo_baza[grepl("^LP\\d{6}$", hipo_baza$Loan_ID), ]  #czyszczenie jeśli nie mają LP i 6 cyfr
hipo_baza <- subset(hipo_baza, Gender %in% c("male", "female")) #czyszczenie jesli nie ma male lub female
hipo_baza <- subset(hipo_baza, Married %in% c("yes", "no")) #czyszczenie jesli nie ma Yes lub No
hipo_baza <- subset(hipo_baza, Education %in% c("graduate", "not graduate")) #czyszczenie jesli graduate lubNot
hipo_baza <- subset(hipo_baza, Self_Employed %in% c("yes", "no")) #czyszczenie jesli nie ma Yes lub No
hipo_baza <- subset(hipo_baza, Credit_History %in% c(1, 0)) #czyszczenie jesli nie ma 1 lub 0
hipo_baza <- subset(hipo_baza, LoanAmount > 0) #czyszczenie jesli jest mniejsze badz równe 0
hipo_baza <- subset(hipo_baza, ApplicantIncome >= 0)#czyszczenie jesli jest mniejsze od 0
hipo_baza <- subset(hipo_baza, CoapplicantIncome >= 0)
hipo_baza <- subset(hipo_baza, Loan_Amount_Term >= 0)
hipo_baza <- subset(hipo_baza, Property_Area %in% c("urban", "semiurban", "rural"))
hipo_baza <- subset(hipo_baza, Dependents >= 0)
```

#Zmiana wartości w kolumach na dane binarne

```{r}
#Kolumna Gender, przekodowanie aby 1 ozn. mężczyzne a 0 kobietę
hipo_baza$Gender <- ifelse(hipo_baza$Gender == "male", 1, 0)

#Kolumna Married, przekodowanie aby 1 ozn. Żonatych a 0 nieżonatych
hipo_baza$Married <- ifelse(hipo_baza$Married == "yes", 1, 0)

#Kolumna Education, przekodowanie aby Graduate =1 a 0=Not Graduate.
hipo_baza$Education <- ifelse(hipo_baza$Education == "graduate", 1, 0)

#Kolumna Self_Employed, przekodowanie Yes=1, No=0
hipo_baza$Self_Employed <- ifelse(hipo_baza$Self_Employed == "yes", 1, 0)

#Kolumna Property_Area urban=1, semiurban=2, rural=3
hipo_baza$Property_Area <- ifelse(hipo_baza$Property_Area == "urban", 1,
                              ifelse(hipo_baza$Property_Area == "semiurban", 2,
                                  ifelse(hipo_baza$Property_Area == "rural", 3, NA)))
```

#Zminaa typu na liczbowy:

```{r}
hipo_baza$Gender <- as.integer(hipo_baza$Gender)
hipo_baza$Married <- as.integer(hipo_baza$Married)
hipo_baza$Dependents <- as.integer(hipo_baza$Dependents)
hipo_baza$Education <- as.integer(hipo_baza$Education)
hipo_baza$Self_Employed <- as.integer(hipo_baza$Self_Employed)
hipo_baza$ApplicantIncome <- as.integer(hipo_baza$ApplicantIncome)
hipo_baza$CoapplicantIncome <- as.integer(hipo_baza$CoapplicantIncome)
hipo_baza$LoanAmount <- as.integer(hipo_baza$LoanAmount)
hipo_baza$Loan_Amount_Term <- as.integer(hipo_baza$Loan_Amount_Term)
hipo_baza$Credit_History <- as.integer(hipo_baza$Credit_History)
hipo_baza$Property_Area <- as.integer(hipo_baza$Property_Area)
```


##Wizualizacja danch
#wykres zależności pomiędzy zarobkami wnioskodawcy a wielkością
miejscowosći zamieszkania

```{r}

hipo_baza$Property_Area <- factor(hipo_baza$Property_Area, 
                                   levels = c(1, 2, 3), 
                                   labels = c("Duże Miasto", "Małe Miasto", "Wieś"))

# Tworzenie wykresu
wykres_zarobki_do_miejscowosci <- ggplot(hipo_baza, aes(x = Property_Area, y = ApplicantIncome, fill = Property_Area)) +
  
  # Dodanie kolorowych punktów
  geom_jitter(aes(color = Property_Area), width = 0.2, size = 2, alpha = 0.7) +
  
  # Skale kolorów
  scale_fill_manual(values = c("Duże Miasto" = "lightgreen", "Małe Miasto" = "violet", "Wieś" = "tomato")) +
  scale_color_manual(values = c("Duże Miasto" = "darkgreen", "Małe Miasto" = "purple", "Wieś" = "red")) +

  coord_cartesian(ylim = c(0, 15000)) +

  
  # Opis osi i tytułu
  labs(
    x = "Obszar",
    y = "Dochód wnioskodawcy",
    title = "Zarobki w zależności od obszaru zamieszkania"
  ) 

# Wyświetlenie wykresu
print(wykres_zarobki_do_miejscowosci)

```

#wykres zależności pomiędzy zarobkami a poziomem edukacji

```{r}

hipo_baza$Education <- factor(hipo_baza$Education, 
                                   levels = c(1, 0),
                                   labels = c("Z wykształceniem", "Bez wykształcenia"))

# Tworzenie wykresu
wykres_zarobki_do_wyksztalcenia <- ggplot(hipo_baza, aes(x = Education, y = ApplicantIncome, fill = Education)) +
  
  # Dodanie kolorowych punktów
  geom_jitter(aes(color = Education), width = 0.2, size = 2, alpha = 0.7) +
  
  # Skale kolorów
  scale_fill_manual(values = c("Z wykształceniem" = "lightgreen", "Bez wykształcenia" = "tomato")) +
  scale_color_manual(values = c("Z wykształceniem" = "darkgreen", "Bez wykształcenia" = "red")) +

  coord_cartesian(ylim = c(0, 15000)) +

  
  # Opis osi i tytułu
  labs(
    x = "Wykształcenie",
    y = "Dochód wnioskodawcy",
    title = "Zarobki w zależności od wykształcenia"
  ) 

# Wyświetlenie wykresu
print(wykres_zarobki_do_wyksztalcenia)


```
#Dochody wnioskodawców różnią się w zależności od miejsca zamieszkania. W dużych miastach występują zarówno niskie, jak i bardzo wysokie zarobki. W małych miastach dochody są bardziej stabilne, ale rzadziej osiągają wysokie wartości. Na wsiach większość dochodów jest niższa, choć zdarzają się wyjątki z bardzo wysokimi zarobkami.


#Wykres wielkość kredytu do obszaru zamieszkania

```{r}
  
  # Tworzenie wykresu
  wykres_kredyt_do_miejscowosci <- ggplot(hipo_baza, aes(x = Property_Area, y = LoanAmount, fill = Property_Area)) +
    
    # Dodanie kolorowych punktów
    geom_jitter(aes(color = Property_Area), width = 0.2, size = 2, alpha = 0.7) +
    
    # Skale kolorów
    scale_fill_manual(values = c("Duże Miasto" = "lightgreen", "Małe Miasto" = "violet", "Wieś" = "tomato")) +
    scale_color_manual(values = c("Duże Miasto" = "darkgreen", "Małe Miasto" = "purple", "Wieś" = "red")) +
    
    # Opis osi i tytułu
    labs(
      x = "Obszar",
      y = "Wielkość kredytu w tyś.",
      title = "Wielkość kredytu w zależności od obszaru zamieszkania"
    ) 
  
  # Wyświetlenie wykresu
  print(wykres_kredyt_do_miejscowosci)
```
#Wielkość kredytów różni się w zależności od miejsca zamieszkania. W dużych miastach występują zarówno małe, jak i wysokie kredyty, z pojedynczymi ekstremalnymi wartościami. W małych miastach kredyty są bardziej skupione wokół średnich wartości, choć pojawiają się nieliczne wysokie wnioski. Na wsiach rozrzut jest większy, a niektóre kredyty osiągają wysokie wartości, co może wynikać z różnych potrzeb finansowych mieszkańców.

#Wykres zarobków w stosunku do płci

```{r}

hipo_baza$Gender <- factor(hipo_baza$Gender, 
                                   levels = c(1, 0),
                                   labels = c("Mężczyzna", "Kobieta"))

# Tworzenie wykresu
wykres_zarobki_do_plci <- ggplot(hipo_baza, aes(x = Gender, y = ApplicantIncome, fill = Gender)) +
  
  # Dodanie kolorowych punktów
  geom_jitter(aes(color = Gender), width = 0.2, size = 2, alpha = 0.7) +
  
  # Skale kolorów
  scale_fill_manual(values = c("Mężczyzna" = "lightgreen", "Kobieta" = "tomato")) +
  scale_color_manual(values = c("Mężczyzna" = "darkgreen", "Kobieta" = "red")) +

  coord_cartesian(ylim = c(0, 15000)) +

  
  # Opis osi i tytułu
  labs(
    x = "Płeć",
    y = "Dochód wnioskodawcy",
    title = "Zarobki w zależności od wykształcenia"
  ) 

# Wyświetlenie wykresu
print(wykres_zarobki_do_plci)

```

#Mężczyźni mają większy rozrzut zarobków i częściej osiągają wyższe dochody. Dochody kobiet są bardziej skupione w niższych przedziałach, choć występują pojedyncze wysokie wartości. Ogólnie, widać wyraźne różnice w rozkładzie zarobków między płciami.


#Wykres kredytu w stostunku do małżeńśtwa

```{r}
hipo_baza$Married <- factor(hipo_baza$Married, 
                                   levels = c(1, 0),
                                   labels = c("Małżeństwo", "Przed ślubem"))

# Tworzenie wykresu
wykres_zarobki_do_malzenstwa <- ggplot(hipo_baza, aes(x = Married, y = LoanAmount, fill = Married)) +
  
  # Dodanie kolorowych punktów
  geom_jitter(aes(color = Married), width = 0.2, size = 2, alpha = 0.7) +
  
  # Skale kolorów
  scale_fill_manual(values = c("Małżeństwo" = "lightgreen", "Przed ślubem" = "tomato")) +
  scale_color_manual(values = c("Małżeństwo" = "darkgreen", "Przed ślubem" = "red")) +

  coord_cartesian(ylim = c(0, 800)) +

  
  # Opis osi i tytułu
  labs(
    x = "Stan cywilny",
    y = "Wielkość kredytu",
    title = "Wielkość kredytu w zależności od stanu cywilnego"
  ) 

# Wyświetlenie wykresu
print(wykres_zarobki_do_malzenstwa)

```

#Osoby w małżeństwie zaciągają kredyty o większym rozrzucie, a niektóre wnioski osiągają bardzo wysokie wartości. Osoby przed ślubem częściej mają kredyty o niższej wartości, z mniejszą liczbą skrajnie wysokich przypadków. Wskazuje to, że status małżeński może wpływać na zdolność kredytową lub potrzeby finansowe.

#Rozkład płci wśród wnioskodawców

```{r}
ggplot(hipo_baza, aes(x = as.factor(Gender), fill = as.factor(Gender))) +
  geom_bar() +
  scale_fill_manual(values = c("Blue", "pink"),
                    labels = c("Mężczyzna", "Kobieta")) +
  ggtitle("Rozkład płci wśród wnioskodawców") +
  xlab("Płeć") +
  ylab("Liczba wnioskodawców")

```
#Wśród wnioskodawców znaczną większość stanowią mężczyźni, których liczba jest ponad trzykrotnie większa niż liczba kobiet. Może to sugerować, że mężczyźni częściej wnioskują o kredyty lub mają większą zdolność kredytową.


```{r}
ggplot(hipo_baza, aes(x = as.factor(Married), fill = as.factor(Married))) +
  geom_bar() +
  scale_fill_manual(values = c("Przed ślubem" = "white", "Małżeństwo" = "black"),
                    labels = c("Małżeńśtwo", "Przed ślubem"))+
  ggtitle("Wykaz stanu cywilnego wśród wnioskodawców") +
  xlab("Stan Cywilny") +
  ylab("Liczba wnioskodawców")


```
#Wśród wnioskodawców dominują osoby pozostające w małżeństwie, których liczba jest wyraźnie większa niż osób przed ślubem. Może to sugerować, że osoby zamężne/cywilnie poślubione częściej ubiegają się o kredyty, być może ze względu na większe potrzeby finansowe lub wyższą zdolność kredytową.

#Rozkład liczby osób na utrzymaniu

```{r}
ggplot(hipo_baza, aes(x = Dependents)) +
  geom_bar(fill = "orange") +
  ggtitle("Liczba osób na utrzymaniu wśród wnioskodawców") +
  xlab("Liczba osób na utrzymaniu") +
  ylab("Liczba wnioskodawców")
```
#Większość wnioskodawców nie ma osób na utrzymaniu, co może sugerować, że kredyty są częściej zaciągane przez osoby samotne lub niezależne finansowo. Znacznie mniejsza grupa ma 1 lub 2 osoby na utrzymaniu, a najmniej wnioskodawców deklaruje utrzymywanie 3 osób. Może to mieć wpływ na zdolność kredytową i wysokość przyznawanych kredytów.


#Dochód wnioskodawcy a kwota kredytu

```{r}
ggplot(hipo_baza, aes(x = ApplicantIncome, y = LoanAmount)) +
  geom_point(color = "blue", alpha = 0.5) +
  coord_cartesian(xlim = c(0, 20000)) +
  ggtitle("Dochód wnioskodawcy a kwota kredytu") + 
  xlab("Dochód") +
  ylab("Kwota Kredytu")
```

#Nie widać wyraźnej zależności między wysokością dochodu a kwotą kredytu. Wnioskodawcy o niskich i średnich dochodach najczęściej ubiegają się o kredyty w przedziale 100–200 tys. zł. Pojedyncze przypadki wysokich kredytów dotyczą zarówno osób o niższych, jak i wyższych dochodach, co może wskazywać na inne czynniki wpływające na decyzję kredytową.


#Rozkład dochodów wnioskodawców

```{r}
ggplot(hipo_baza, aes(x = ApplicantIncome)) +
  geom_histogram(bins = 30, fill = "green", color = "black") +
  coord_cartesian(xlim = c(0, 20000)) +
  ggtitle("Rozkład dochodów wnioskodawców")+
  xlab("Dochód") +
  ylab("Ilość wniosków")
  
```
#Większość wnioskodawców ma dochody poniżej 10 000 zł, z największą grupą w przedziale 2500–5000 zł. Dochody powyżej 10 000 zł są rzadkie, a ekstremalnie wysokie wartości występują sporadycznie. Rozkład jest prawostronnie skośny, co sugeruje, że znaczna część osób ma stosunkowo niskie zarobki, a tylko nieliczne osiągają bardzo wysokie dochody.

#Porównanie średniej wartosci kredytu do zatrudnienia
 
```{r}
srednia_kredytu <- aggregate(LoanAmount ~ Self_Employed, data = hipo_baza, FUN = mean, na.rm = TRUE)
kable(srednia_kredytu, format = "html", align = "c",
      col.names = c("Status Zatrudnienia", "Średnia Kwota Pożyczki (tyś)")) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"),
                full_width = FALSE, position = "center") %>%
  column_spec(1, bold = TRUE, color = "white", background = "#0073e6") %>%
  column_spec(2, bold = TRUE, background = "#f2f2f2") %>%
  add_header_above(c("Analiza Kredytów" = 2))
```

#Średnia kwota kredytu dla osób samozatrudnionych wynosi 150,19, natomiast dla osób niebędących samozatrudnionymi 134,77. Oznacza to, że samozatrudnieni otrzymują średnio o 15,42 jednostek więcej kredytu. Może to wynikać z ich wyższej zdolności kredytowej, potrzeby finansowania działalności gospodarczej lub większej skłonności do zaciągania większych zobowiązań.

#Rozkład dochodów wnioskodawców

```{r}
ggplot(hipo_baza, aes(x = Credit_History)) +
  geom_bar(fill = "purple", color = "black") +
  ggtitle("Historia kredytowa pośród wnioskodawców") +
  xlab("Historia Kredytowa") +
  ylab("Ilość wniosków")
  
  
```
#Większość wnioskodawców posiada pozytywną historię kredytową (wartość 1), co może zwiększać ich szanse na uzyskanie kredytu. Znacznie mniejsza grupa osób nie ma historii kredytowej lub ma negatywną (wartość 0), co może utrudniać uzyskanie finansowania. To sugeruje, że banki częściej obsługują klientów z ugruntowaną historią kredytową.

#Wzorce wielkości kredytów do ilości domowników w różnych typach
zurbanizowania

```{r}
Wykres_ilosc_domownikow_kredyt_zamieszkanie <- ggplot(hipo_baza, aes(LoanAmount, Dependents)) +
  geom_abline() +
  geom_jitter(width = 0.1, height = 0.1)
Wykres_ilosc_domownikow_kredyt_zamieszkanie + facet_wrap(~Property_Area)+
  xlab("Wielkość kredytu") +
  ylab("Liczba osób na utrzymaniu")

```
#większość kredytobiorców ma 0–1 osoby na utrzymaniu i zaciąga kredyty o niższych wartościach. Wnioskodawcy z większą liczbą domowników (2–3) również uzyskują kredyty, ale nie ma wyraźnej zależności między liczbą osób na utrzymaniu a wysokością kredytu. Rozkład jest dość równomierny w różnych obszarach, co sugeruje, że liczba osób na utrzymaniu nie jest kluczowym czynnikiem wpływającym na kwotę kredytu.

#Ponowna zmiana wartości w kolumach na dane binarne

```{r}
#Kolumna Gender, przekodowanie aby 1 ozn. mężczyzne a 0 kobietę
hipo_baza$Gender <- ifelse(hipo_baza$Gender == "Mężczyzna", 1, 0)

#Kolumna Married, przekodowanie aby 1 ozn. Żonatych a 0 nieżonatych
hipo_baza$Married <- ifelse(hipo_baza$Married == "Małżeństwo", 1, 0)

#Kolumna Education, przekodowanie aby Graduate =1 a 0=Not Graduate.
hipo_baza$Education <- ifelse(hipo_baza$Education == "Z wykształceniem", 1, 0)

#Kolumna Self_Employed, przekodowanie Yes=1, No=0
hipo_baza$Self_Employed <- ifelse(hipo_baza$Self_Employed == "yes", 1, 0)

#Kolumna Property_Area urban=1, semiurban=2, rural=3
hipo_baza$Property_Area <- ifelse(hipo_baza$Property_Area == "Duże Miasto", 1,
                              ifelse(hipo_baza$Property_Area == "Małe Miasto", 2,
                                  ifelse(hipo_baza$Property_Area == "Wieś", 3, NA)))
```

#Ponowna Zminaa typu na liczbowy:

```{r}
hipo_baza$Gender <- as.integer(hipo_baza$Gender)
hipo_baza$Married <- as.integer(hipo_baza$Married)
hipo_baza$Dependents <- as.integer(hipo_baza$Dependents)
hipo_baza$Education <- as.integer(hipo_baza$Education)
hipo_baza$Self_Employed <- as.integer(hipo_baza$Self_Employed)
hipo_baza$ApplicantIncome <- as.integer(hipo_baza$ApplicantIncome)
hipo_baza$CoapplicantIncome <- as.integer(hipo_baza$CoapplicantIncome)
hipo_baza$LoanAmount <- as.integer(hipo_baza$LoanAmount)
hipo_baza$Loan_Amount_Term <- as.integer(hipo_baza$Loan_Amount_Term)
hipo_baza$Credit_History <- as.integer(hipo_baza$Credit_History)
hipo_baza$Property_Area <- as.integer(hipo_baza$Property_Area)
```

##Analiza Opisowa #Postawowe dane dla dochodów i kredytów

```{r}
stat_dochod_kredyt <- summary(hipo_baza[, c("ApplicantIncome", "CoapplicantIncome", "LoanAmount")])

kable(stat_dochod_kredyt, format = "html", align = "c",
      col.names = c("Dochód Wnioskodawcy", "Dochód Współwnioskodawcy", "Kwota Kredytu (Tyś)")) %>%
  row_spec(0, bold = TRUE, font_size = 14, color = "white", background = "green") %>%
  kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"),
                full_width = FALSE, position = "center") %>%
  add_header_above(c("Analiza Kredytów" = 4))
```
#Większość wnioskodawców ma dochody w przedziale 2864 – 5060, jednak pojedyncze przypadki bardzo wysokich zarobków podnoszą średnią. Współwnioskodawcy często nie mają dochodu, co sugeruje, że wiele wniosków opiera się na jednym źródle dochodu. Średnia kwota kredytu wynosi 136,3, a większość kredytów mieści się w zakresie 101 – 157,5, choć zdarzają się znacznie wyższe wnioski.

```{r}
suma_bazy <- summary(hipo_baza)
kable(suma_bazy, format = "html", align = "c",
      col.names = c("Loan_ID", "Gender", "Married", "Dependents", "Education", "Self_Employed",
                  "ApplicantIncome", "CoapplicantIncome", "LoanAmount", "Loan_Amount_Term",
                  "Credit_History", "Property_Area")) %>%
  row_spec(0, bold = TRUE, font_size = 14, color = "black", background = "grey") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "bordered"),
                full_width = FALSE, position = "center")
  

```
#Większość wnioskodawców to mężczyźni (80,9%), osoby zamężne (63,5%) i posiadające wyższe wykształcenie (71,1%). Dochody głównego wnioskodawcy są zróżnicowane, ale mediana wynosi 3786, a średnia 4806 – co wskazuje na obecność wysokich wartości odstających. Współwnioskodawcy często nie mają dochodu.
#Większość kredytów opiewa na 126–136 tys. i jest udzielana na 30 lat. Wnioskodawcy z pozytywną historią kredytową dominują, co sugeruje, że historia kredytowa ma istotny wpływ na decyzję o przyznaniu finansowania.


```{r}
cor(hipo_baza[, sapply(hipo_baza, is.numeric)], use = "complete.obs")

```
#Kwota kredytu jest najsilniej skorelowana z dochodem głównego wnioskodawcy (0,49), co oznacza, że im wyższy dochód, tym większy kredyt. Dochód współwnioskodawcy ma mniejszy wpływ (0,15). Liczba osób na utrzymaniu, stan cywilny, historia kredytowa i obszar zamieszkania mają bardzo słabe korelacje z innymi zmiennymi, co sugeruje, że nie są kluczowymi czynnikami w decyzjach kredytowych.

#podstawowe dane statystyczne dla całej bazy
```{r}
wyniki_descr <- descr(hipo_baza[, 2:10],
                      stats = c("min", "max", "mean", "sd"),
                      transpose = TRUE)  # Opcjonalnie transponujemy wynik dla lepszej czytelności

# Wyświetlenie wyników
print(wyniki_descr)
```
#Większość wnioskodawców ma dochody w przedziale 2864 – 5060, ale duże odchylenie standardowe wskazuje na znaczne różnice między zarobkami. Współwnioskodawcy często nie mają dochodu, co oznacza, że kredyty są głównie przyznawane na podstawie zarobków głównego wnioskodawcy.
#Średnia kwota kredytu wynosi 136,32, a większość kredytów udzielana jest na 30 lat. Ponad 63% wnioskodawców jest w związku małżeńskim. Brak danych dla samozatrudnionych może sugerować konieczność weryfikacji zbioru danych.


#Występowanie Płuci w wnioskach kreydtowych
```{r}
wyniki_freq <- freq(hipo_baza$Gender,
                    report.nas = FALSE,  # Wyłączenie raportu o brakujących danych
                    plain.ascii = TRUE)  # Użycie formatu ASCII (dobry przy wyświetlaniu w konsoli)

# Wyświetlenie wyników
print(wyniki_freq)
```

#Wśród wnioskodawców 80,93% stanowią mężczyźni (297 osób), a 19,07% kobiety (70 osób). Wskazuje to na znaczną przewagę mężczyzn w grupie ubiegających się o kredyt. Może to wynikać z różnic w dochodach, strukturze gospodarstw domowych lub preferencjach finansowych.

#Tabela krzyżowa historii kredytowej do wielkości kredytu
```{r}
hipo_baza$Credit_History <- factor(hipo_baza$Credit_History)
hipo_baza$LoanAmount_cat <- cut(hipo_baza$LoanAmount, 
                                breaks = c(0, 100, 200, 300, 1000), 
                                include.lowest = TRUE, 
                                labels = c("0 do 100", "100-200", "200-300", "300+"))

# Generowanie tabeli krzyżowej z jawnie ustawionym zaokrągleniem
tabela_krzyzowa <- ctable(hipo_baza$Credit_History, hipo_baza$LoanAmount_cat, prop = "n", round.digits = 2)
tabela_krzyzowa
```

#Osoby z pozytywną historią kredytową częściej otrzymują wyższe kredyty – 64,29% z nich mieści się w przedziale 100-200 tys., a 1,95% przekracza 300 tys.. Natomiast osoby bez historii kredytowej rzadko dostają wysokie kredyty – aż 81,36% otrzymuje kwoty 100-200 tys., a nikt nie przekracza 300 tys..
#Brak historii kredytowej znacząco ogranicza dostęp do wyższych kredytów.


#Podsumowanie wszystkich statysyk dla wszystkich zmiennych
```{r}
podsumowanie <- dfSummary(hipo_baza,
                           method = "render")
view(podsumowanie)

```
#Większość wnioskodawców to mężczyźni (80,9%), osoby zamężne (63,5%) i posiadające wyższe wykształcenie (77,1%). Ponad połowa nie ma osób na utrzymaniu (57,2%).

#Średni dochód głównego wnioskodawcy wynosi 4805,6, ale jest mocno zróżnicowany. Współwnioskodawcy często nie mają dochodu, a jeśli mają, to średnio 1569,6. Średnia kwota kredytu wynosi 136,3, a większość mieści się w przedziale 100-200 tys..

#Większość kredytów udzielana jest na 30 lat, a 83,9% wnioskodawców ma pozytywną historię kredytową, co zwiększa ich szanse na uzyskanie finansowania.


##Wnioskowanie Statystyczne

#Satystyka Długosci kredytu to wielkości
```{r}
ggbetweenstats(
  data = hipo_baza,
  x = Loan_Amount_Term,
  y = LoanAmount, 
  type = "parametric", 
)

```

#Najczęściej udzielane kredyty mają okres 360 miesięcy (30 lat), ze średnią kwotą 133 tys.. Krótsze kredyty (np. 6–36 miesięcy) mają większą zmienność kwot – od 95 tys. do 260 tys.. Kredyty na 15 lat (180 miesięcy) mają najniższą średnią kwotę (80 tys.). Dłuższe okresy kredytowania wiążą się z większym rozproszeniem wartości kredytów.

#wizualizację zależności między wielkościa kredytu a stusem cywilnym wraz z wynikami testu korelacji
```{r}
ggscatterstats(
  data = hipo_baza,
  x = LoanAmount,
  y = Married,
)

```
#Osoby w związku małżeńskim częściej otrzymują wyższe kredyty, ale związek ten jest słaby (r = 0,18). Stan cywilny może mieć pewien wpływ na wysokość kredytu, jednak inne czynniki, jak dochód czy historia kredytowa, są bardziej istotne.

#Model regresji liniowej zależność dochodu od statusu cwyilnego i płuci
```{r}
model_dochod <- lm(ApplicantIncome ~ Married + Gender, data = hipo_baza)
ggcoefstats(model_dochod)

```
#Analiza regresji wskazuje, że płeć i stan cywilny nie mają istotnego wpływu na dochód wnioskodawcy (p > 0,05). Jedynie wyraz wolny modelu (β = 4023,65, p < 0,001) jest istotny, co sugeruje, że inne czynniki niż płeć czy stan cywilny lepiej wyjaśniają poziom dochodów.

#Wielkość kredytu zależna od  statusu cwyilnego, płuci i Historii Kredytowej
```{r}
  model_wielkosc_kredytu <- lm(LoanAmount ~ Married + Gender + Credit_History, data = hipo_baza)
  ggcoefstats(model_wielkosc_kredytu)

```
#Stan cywilny ma istotny, ale niewielki wpływ na kwotę kredytu (β = 22,39, p = 0,001). Płeć i historia kredytowa nie są istotnymi predyktorami (p > 0,05). Główne czynniki wpływające na kwotę kredytu to prawdopodobnie dochód i inne zmienne nieuwzględnione w tym modelu.

